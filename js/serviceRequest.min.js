/* serviceRequest.min.js • v1.0 • a promised-based alternative API to OrchestraCMS’s doServiceRequest() */
!function(e,r){_createServiceRequestAs=function(e,s,t){function n(e,r){return void 0===e&&(e=r),"string"==typeof e&&(e=e.toLowerCase().indexOf("write")>=0||(e.toLowerCase().indexOf("readonly"),!1)),!e}function o(e,r){"success"!==e&&console&&console.warn("• Unsuccessful service request",e,r)}console&&console.assert("promise"===e||"deferred"===e,"unsupported promiseType specified"),"string"==typeof s&&(s={service:s}),void 0===t&&(t=!1);return"promise"===e?function(e,c){return new Promise(function(i,u){"string"==typeof e&&(e={action:e}),e=r.extend({},s,e),doServiceRequest(e,{cb:function(e,r){if(r.status)try{var s=JSON.parse(e);i(s)}catch(r){i(e)}else u(r.message)},cbHandlerOnComplete:o,readonly:n(c,t)})})}:function(e,c){var i=r.Deferred();return"string"==typeof e&&(e={action:e}),e=r.extend({},s,e),doServiceRequest(e,{cb:function(e,r){if(r.status)try{var s=JSON.parse(e);i.resolve(s)}catch(r){i.resolve(e)}else i.reject(r.message)},cbHandlerOnComplete:o,readonly:n(c,t)}),i.promise()}},e.createServiceRequestAsPromise=_createServiceRequestAs.bind(e,"promise"),e.createServiceRequestAsDeferred=_createServiceRequestAs.bind(e,"deferred"),e.doServiceRequestAsPromise=function(r,s,t){return e.createServiceRequestAsPromise(r,s,t)()},e.doServiceRequestAsDeferred=function(r,s,t){return e.createServiceRequestAsDeferred(r,s,t)()}}(window,jQuery);